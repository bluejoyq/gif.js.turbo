(()=>{var t={376:(t,i,e)=>{var s=e(285),r=e(756);function n(){this.page=-1,this.pages=[],this.newPage()}function a(t,i,e){const s=function(t){return t*t};return s(t[e]-i[e])+s(t[e+1]-i[e+1])+s(t[e+2]-i[e+2])}n.pageSize=4096,n.charMap={};for(var o=0;o<256;o++)n.charMap[o]=String.fromCharCode(o);function h(t,i){this.width=~~t,this.height=~~i,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.transIndexValue=Math.pow(2,this.palSize+1)-1,this.applyCropOptimization=!1,this.transparencyDifferenceThreshold=1,this.applyTransparencyOptimization=!1,this.xOffset=0,this.yOffset=0,this.yEnd=this.height-1,this.xEnd=this.width-1,this.out=new n}n.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(n.pageSize),this.cursor=0},n.prototype.getData=function(){for(var t="",i=0;i<this.pages.length;i++)for(var e=0;e<n.pageSize;e++)t+=n.charMap[this.pages[i][e]];return t},n.prototype.writeByte=function(t){this.cursor>=n.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=t},n.prototype.writeUTFBytes=function(t){for(var i=t.length,e=0;e<i;e++)this.writeByte(t.charCodeAt(e))},n.prototype.writeBytes=function(t,i,e){for(var s=e||t.length,r=i||0;r<s;r++)this.writeByte(t[r])},h.prototype.setApplyTransparencyOptimization=function(t){this.applyTransparencyOptimization=t},h.prototype.setTransparencyDifferenceThreshold=function(t){this.transparencyDifferenceThreshold=t},h.prototype.setApplyCropOptimization=function(t){this.applyCropOptimization=t},h.prototype.setDelay=function(t){this.delay=Math.round(t/10)},h.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)},h.prototype.setDispose=function(t){t>=0&&(this.dispose=t)},h.prototype.setRepeat=function(t){this.repeat=t},h.prototype.setTransparent=function(t){this.transparent=t},h.prototype.addFrame=function(t,i){this.image=t,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels();var e=null;i&&(e=function(t,i,e){for(var s=new Uint8Array(i*e*3),r=0,n=0,a=0;a<e;a++)for(var o=0;o<i;o++)s[n++]=t[r++],s[n++]=t[r++],s[n++]=t[r++],r++;return s}(i,this.width,this.height)),this.analyzePixels(e),!0===this.globalPalette&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.globalPalette||this.writePalette(),this.writePixels(),this.firstFrame=!1},h.prototype.finish=function(){this.out.writeByte(59)},h.prototype.setQuality=function(t){t<1&&(t=1),this.sample=t},h.prototype.setDither=function(t){!0===t&&(t="FloydSteinberg"),this.dither=t},h.prototype.setGlobalPalette=function(t){this.globalPalette=t},h.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette},h.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")},h.prototype.analyzePixels=function(t){this.colorTab||(this.neuQuant=new s(this.pixels,this.sample,!0),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),null!==this.dither.match(/-serpentine/),t):this.indexPixels(t),this.applyCropOptimization&&t&&this.cropIndexedPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,this.applyTransparencyOptimization?this.transIndex=this.transIndexValue:null!==this.transparent&&(this.transIndex=this.findClosest(this.transparent,!0))},h.prototype.indexPixels=function(t){var i=this.pixels.length/3;this.indexedPixels=new Uint8Array(i);for(var e,s,r,n=0,a=0;a<i;a++){var o=-1;t&&(e=this.pixels,s=t,r=n,Math.abs(e[r]-s[r])+Math.abs(e[r+1]-s[r+1])+Math.abs(e[r+2]-s[r+2])<this.transparencyDifferenceThreshold)&&(o=this.transIndexValue,n+=3),-1==o&&(o=this.findClosestRGB(255&this.pixels[n++],255&this.pixels[n++],255&this.pixels[n++])),this.usedEntry[o]=!0,this.indexedPixels[a]=o}},h.prototype.cropIndexedPixels=function(){for(;this.yOffset<this.yEnd;){for(var t=!0,i=0;i<this.width;i++)if(this.indexedPixels[this.width*this.yOffset+i]!==this.transIndexValue){t=!1;break}if(!t)break;this.yOffset++}for(;this.yEnd>this.yOffset;){for(t=!0,i=0;i<this.width;i++)if(this.indexedPixels[this.width*this.yEnd+i]!==this.transIndexValue){t=!1;break}if(!t)break;this.yEnd--}for(;this.xOffset<this.xEnd;){for(t=!0,i=this.yOffset;i<this.yEnd;i++)if(this.indexedPixels[this.width*i+this.xOffset]!==this.transIndexValue){t=!1;break}if(!t)break;this.xOffset++}for(;this.xEnd>this.xOffset;){for(t=!0,i=this.yOffset;i<this.yEnd;i++)if(this.indexedPixels[this.width*i+this.xEnd]!==this.transIndexValue){t=!1;break}if(!t)break;this.xEnd--}},h.prototype.calculateAndPropogateErrorDither=function(t,i,e,s,r){var n={FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[2/8,1,1]],FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]]};if(!s||!n[s])throw"Unknown dithering kernel: "+s;var a=n[s],o=r?-1:1,h=e*this.width+i,l=3*h,p=t[l],f=t[l+1],u=t[l+2],c=this.findClosestRGB(p,f,u);l=3*c;for(var y=p-this.colorTab[l],d=f-this.colorTab[l+1],w=u-this.colorTab[l+2],x=1==o?0:a.length-1,g=1==o?a.length:0;x!==g;x+=o){var b=a[x][1],m=a[x][2];if(b+i>=0&&b+i<this.width&&m+e>=0&&m+e<this.height){var v=a[x][0];l=h+b+m*this.width,t[l*=3]=Math.max(0,Math.min(255,t[l]+y*v)),t[l+1]=Math.max(0,Math.min(255,t[l+1]+d*v)),t[l+2]=Math.max(0,Math.min(255,t[l+2]+w*v))}}return c},h.prototype.ditherPixels=function(t,i,e){var s=0,r=this.height,n=this.width,o=(this.pixels,i?-1:1);this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var h=0;h<r;h++){i&&(o*=-1);for(var l=1==o?0:n-1,p=1==o?n:0;l!==p;l+=o){s=h*n+l;var f=this.calculateAndPropogateErrorDither(this.pixels,l,h,t,i);e&&(f===this.calculateAndPropogateErrorDither(e,l,h,t,i)||a(this.pixels,e,3*s)<this.transparencyDifferenceThreshold*this.transparencyDifferenceThreshold)&&(f=this.transIndexValue),this.usedEntry[f]=!0,this.indexedPixels[s]=f}}},h.prototype.findClosest=function(t,i){return this.findClosestRGB((16711680&t)>>16,(65280&t)>>8,255&t,i)},h.prototype.findClosestRGB=function(t,i,e,s){if(null===this.colorTab)return-1;if(this.neuQuant&&!s)return this.neuQuant.lookupRGB(t,i,e);for(var r=0,n=16777216,a=this.colorTab.length,o=0,h=0;o<a;h++){var l=t-(255&this.colorTab[o++]),p=i-(255&this.colorTab[o++]),f=e-(255&this.colorTab[o++]),u=l*l+p*p+f*f;(!s||this.usedEntry[h])&&u<n&&(n=u,r=h)}return r},h.prototype.getImagePixels=function(){var t=this.width,i=this.height;this.pixels=new Uint8Array(t*i*3);for(var e=this.image,s=0,r=0,n=0;n<i;n++)for(var a=0;a<t;a++)this.pixels[r++]=e[s++],this.pixels[r++]=e[s++],this.pixels[r++]=e[s++],s++},h.prototype.writeGraphicCtrlExt=function(){var t,i;this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4),null===this.transparent?(t=0,i=0):(t=1,i=2),this.applyTransparencyOptimization&&(i=1,t=1),this.dispose>=0&&(i=7&this.dispose),i<<=2,this.out.writeByte(0|i|t),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},h.prototype.writeImageDesc=function(){var t=this.yEnd-this.yOffset+1,i=this.xEnd-this.xOffset+1;this.out.writeByte(44),this.writeShort(this.xOffset),this.writeShort(this.yOffset),this.writeShort(i),this.writeShort(t),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},h.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},h.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},h.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var t=768-this.colorTab.length,i=0;i<t;i++)this.out.writeByte(0)},h.prototype.writeShort=function(t){this.out.writeByte(255&t),this.out.writeByte(t>>8&255)},h.prototype.writePixels=function(){for(var t=this.yEnd-this.yOffset+1,i=this.xEnd-this.xOffset+1,e=new Uint8Array(i*t),s=0,n=this.yOffset;n<=this.yEnd;n++)e.set(this.indexedPixels.slice(n*this.width+this.xOffset,n*this.width+this.xOffset+i),s),s+=i;new r(i,t,e,this.colorDepth).encode(this.out)},h.prototype.stream=function(){return this.out},t.exports=h},756:t=>{var i=5003,e=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];t.exports=function(t,s,r,n){var a,o,h,l,p,f,u=Math.max(2,n),c=new Uint8Array(256),y=new Int32Array(i),d=new Int32Array(i),w=0,x=0,g=!1;function b(t,i){c[o++]=t,o>=254&&P(i)}function m(t){v(i),x=p+2,g=!0,O(p,t)}function v(t){for(var i=0;i<t;++i)y[i]=-1}function P(t){o>0&&(t.writeByte(o),t.writeBytes(c,0,o),o=0)}function T(t){return(1<<t)-1}function B(){return 0===remaining?-1:(--remaining,255&r[curPixel++])}function O(t,i){for(a&=e[w],w>0?a|=t<<w:a=t,w+=n_bits;w>=8;)b(255&a,i),a>>=8,w-=8;if((x>h||g)&&(g?(h=T(n_bits=l),g=!1):(++n_bits,h=12==n_bits?4096:T(n_bits))),t==f){for(;w>0;)b(255&a,i),a>>=8,w-=8;P(i)}}this.encode=function(e){e.writeByte(u),remaining=t*s,curPixel=0,function(t,e){var s,r,n,a,u,c;for(l=t,g=!1,n_bits=l,h=T(n_bits),f=1+(p=1<<t-1),x=p+2,o=0,a=B(),c=0,s=i;s<65536;s*=2)++c;c=8-c,v(i),O(p,e);t:for(;-1!=(r=B());)if(s=(r<<12)+a,y[n=r<<c^a]!==s){if(y[n]>=0){u=5003-n,0===n&&(u=1);do{if((n-=u)<0&&(n+=5003),y[n]===s){a=d[n];continue t}}while(y[n]>=0)}O(a,e),a=r,x<4096?(d[n]=x++,y[n]=s):m(e)}else a=d[n];O(a,e),O(f,e)}(u+1,e),e.writeByte(0)}}},285:t=>{var i=256,e=i-1,s=64*(i>>3),r=1024,n=1<<18;t.exports=function(t,a,o){var h,l,p,f,u;function c(t,i,e,s,n){h[i][0]-=t*(h[i][0]-e)/r,h[i][1]-=t*(h[i][1]-s)/r,h[i][2]-=t*(h[i][2]-n)/r}function y(t,e,s,r,a){for(var o,l,p=Math.abs(e-t),f=Math.min(e+t,i),c=e+1,y=e-1,d=1;c<f||y>p;)l=u[d++],c<f&&((o=h[c++])[0]-=l*(o[0]-s)/n,o[1]-=l*(o[1]-r)/n,o[2]-=l*(o[2]-a)/n),y>p&&((o=h[y--])[0]-=l*(o[0]-s)/n,o[1]-=l*(o[1]-r)/n,o[2]-=l*(o[2]-a)/n)}function d(t,e,s){t|=0,e|=0,s|=0;var r,n,a,o,l,u=~(1<<31),c=u,y=-1,d=y;for(r=0;r<i;r++)n=h[r],(a=Math.abs((0|n[0])-t)+Math.abs((0|n[1])-e)+Math.abs((0|n[2])-s)|0)<u&&(u=a,y=r),(o=a-((0|p[r])>>12))<c&&(c=o,d=r),l=f[r]>>10,f[r]-=l,p[r]+=l<<10;return f[y]+=64,p[y]-=65536,d}o&&(i-=1,e-=1),this.buildColormap=function(){!function(){var t,e;for(h=[],l=new Int32Array(256),p=new Int32Array(i),f=new Int32Array(i),u=new Int32Array(i>>3),t=0;t<i;t++)e=(t<<12)/i,h[t]=new Float64Array([e,e,e,0]),f[t]=65536/i,p[t]=0}(),function(){var i,e,n,o,h,l,p=t.length,f=30+(a-1)/3,w=p/(3*a),x=~~(w/100),g=r,b=s,m=b>>6;for(m<=1&&(m=0),i=0;i<m;i++)u[i]=g*(256*(m*m-i*i)/(m*m));p<1509?(a=1,e=3):e=p%499!=0?1497:p%491!=0?1473:p%487!=0?1461:1509;var v=0;for(i=0;i<w;)if(c(g,l=d(n=(255&t[v])<<4,o=(255&t[v+1])<<4,h=(255&t[v+2])<<4),n,o,h),0!==m&&y(m,l,n,o,h),(v+=e)>=p&&(v-=p),0===x&&(x=1),++i%x==0)for(g-=g/f,(m=(b-=b/30)>>6)<=1&&(m=0),l=0;l<m;l++)u[l]=g*(256*(m*m-l*l)/(m*m))}(),function(){for(var t=0;t<i;t++)h[t][0]>>=4,h[t][1]>>=4,h[t][2]>>=4,h[t][3]=t}(),function(){var t,s,r,n,a,o,p=0,f=0;for(t=0;t<i;t++){for(a=t,o=(r=h[t])[1],s=t+1;s<i;s++)(n=h[s])[1]<o&&(a=s,o=n[1]);if(n=h[a],t!=a&&(s=n[0],n[0]=r[0],r[0]=s,s=n[1],n[1]=r[1],r[1]=s,s=n[2],n[2]=r[2],r[2]=s,s=n[3],n[3]=r[3],r[3]=s),o!=p){for(l[p]=f+t>>1,s=p+1;s<o;s++)l[s]=t;p=o,f=t}}for(l[p]=f+e>>1,s=p+1;s<256;s++)l[s]=e}()},this.getColormap=function(){for(var t=[],e=[],s=0;s<i;s++)e[h[s][3]]=s;for(var r=0,n=0;n<i;n++){var a=e[n];t[r++]=h[a][0],t[r++]=h[a][1],t[r++]=h[a][2]}return t},this.lookupRGB=function(t,e,s){var r,n,a;t|=0,s|=0;for(var o=1e3,p=-1,f=0|l[e|=0],u=f-1;f<i||u>=0;)f<i&&((a=(0|(n=h[f])[1])-e)>=o?f=i:(f++,a<0&&(a=-a),(r=(0|n[0])-t)<0&&(r=-r),(a+=r)<o&&((r=(0|n[2])-s)<0&&(r=-r),(a+=r)<o&&(o=a,p=0|n[3])))),u>=0&&((a=e-(0|(n=h[u])[1]))>=o?u=-1:(u--,a<0&&(a=-a),(r=(0|n[0])-t)<0&&(r=-r),(a+=r)<o&&((r=(0|n[2])-s)<0&&(r=-r),(a+=r)<o&&(o=a,p=0|n[3]))));return p}}},357:(t,i,e)=>{const s=e(376),r=t=>{const i=new s(t.width,t.height);0===t.index?i.writeHeader():i.firstFrame=!1,i.setDispose(t.dispose),i.setTransparencyDifferenceThreshold(t.transparencyDifferenceThreshold),i.setApplyTransparencyOptimization(t.applyTransparencyOptimization),i.setApplyCropOptimization(t.applyCropOptimization);const e=t.previousFrameData?t.previousFrameData:null;i.setTransparent(t.transparent),i.setRepeat(t.repeat),i.setDelay(t.delay),i.setQuality(t.quality),i.setDither(t.dither),i.setGlobalPalette(t.globalPalette),i.addFrame(t.data,e),t.last&&i.finish(),!0===t.globalPalette&&(t.globalPalette=i.getGlobalPalette());const r=i.stream();t.data=r.pages,t.cursor=r.cursor,t.pageSize=r.constructor.pageSize;const n={cursor:t.cursor,pageSize:t.pageSize,data:t.data,canTransfer:t.canTransfer,index:t.index};if(n.canTransfer){const t=n.data.map((t=>t.buffer));self.postMessage(n,t)}else self.postMessage(n)};self.onmessage=t=>r(t.data),t.exports=r}},i={};!function e(s){var r=i[s];if(void 0!==r)return r.exports;var n=i[s]={exports:{}};return t[s](n,n.exports,e),n.exports}(357)})();
//# sourceMappingURL=gif.worker.js.map